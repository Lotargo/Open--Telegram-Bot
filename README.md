# AI Portfolio Bot

Telegram бот-визитка, который работает как "умный секретарь". Бот использует LLM (Groq) для ответов на вопросы о услугах и ценах, а также для оформления заявок от клиентов.

## Функционал

*   **Умный секретарь:** Отвечает на вопросы, используя прайс-лист из базы данных и инструкции из `config/system_prompt.j2`.
*   **Заявки:** Собирает данные клиента и формирует карточку заявки. Использует JSON для надежного парсинга ответов LLM.
*   **Сбор Контактов:** Поддерживает кнопку "Поделиться контактом" для быстрого ввода телефона.
*   **Подтверждение:** Требует явного подтверждения от пользователя (Инлайн-кнопка) перед отправкой админу.
*   **Rate Limiting:** Защита от спама (настраивается в `config/bot_config.yaml`).
*   **Конфигурация:** Все настройки (модель, температура, промпты) вынесены в папку `config/`.

## Установка и запуск

1.  **Создайте .env файл:**
    Скопируйте пример из инструкции ниже и вставьте свои ключи.
    ```env
    BOT_TOKEN=ваш_токен_бота
    ADMIN_GROUP_ID=
    GROQ_API_KEY=ваш_ключ_groq
    MONGO_URI=mongodb://mongo:27017/portfolio_bot
    ```

2.  **Установка зависимостей (Poetry):**
    Проект использует Poetry для управления зависимостями.
    ```bash
    # Установите Poetry (если нет)
    curl -sSL https://install.python-poetry.org | python3 -

    # Установите зависимости и создайте .venv
    poetry install

    # Активация окружения (для локальной разработки)
    source .venv/bin/activate
    ```

3.  **Запуск через Docker Compose:**
    ```bash
    docker-compose up --build -d
    ```

4.  **Настройка Админа:**
    *   Добавьте бота в группу или напишите ему лично.
    *   Напишите команду `/set_admin`.
    *   Бот пришлет ID чата. Вставьте этот ID в `.env` файл (`ADMIN_GROUP_ID`).
    *   Перезапустите бота: `docker-compose restart bot`

## Разработка

*   **Config:**
    *   `config/llm_config.yaml`: Модель, параметры LLM.
    *   `config/system_prompt.j2`: Системный промпт (Jinja2 шаблон).
    *   `config/bot_config.yaml`: Лимиты, логирование.

## Стек

*   Python 3.11+
*   Poetry (Dependency Management)
*   Aiogram 3.x
*   MongoDB (pymongo)
*   OpenAI SDK (Async)
*   Jinja2 (Templating)
*   Docker & Docker Compose
